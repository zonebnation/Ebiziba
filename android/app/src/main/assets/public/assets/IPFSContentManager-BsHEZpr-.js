import{j as e,m as t}from"./framer--EiQgGdQ.js";import{r}from"./vendor-fbM9bkeS.js";import{c as a,L as s,a as i,R as n,I as l,s as c}from"./index-CGXY-R5d.js";import{D as o}from"./database-CDsHRqV3.js";import{T as d}from"./trash-2-q4_jv6YM.js";import"./utils-DiRS1ToC.js";import"./supabase-DkUcngs9.js";import"./ui-Yji1MIDK.js";
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=a("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),m=()=>{const[a,m]=r.useState([]),[g,y]=r.useState(!0),[h,p]=r.useState(null),[u,f]=r.useState(!1);r.useEffect((()=>{(async()=>{try{const e=l.getInstance(),t=await e.initialize();f(t),t&&j()}catch(e){console.error("Failed to initialize IPFS service:",e),p("Failed to initialize IPFS service"),y(!1)}})()}),[]);const j=async()=>{try{y(!0),p(null);const{data:e,error:t}=await c.from("ipfs_content").select("*").order("created_at",{ascending:!1});if(t)throw t;m(e||[])}catch(e){console.error("Error fetching IPFS content:",e),p("Failed to load IPFS content")}finally{y(!1)}},b=e=>{if(!e)return"Unknown";const t=["B","KB","MB","GB"];let r=e,a=0;for(;r>=1024&&a<t.length-1;)r/=1024,a++;return`${r.toFixed(2)} ${t[a]}`},k=e=>{switch(e){case"book":return"📚";case"image":return"🖼️";case"audio":return"🔊";case"video":return"🎬";default:return"📄"}};return g?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(s,{className:"w-8 h-8 text-primary-500 animate-spin"})}):h?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-6 text-center",children:[e.jsx(i,{className:"w-12 h-12 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-red-500 mb-4",children:h}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:"Try Again"})]}):u?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"IPFS Content Registry"}),e.jsx("button",{onClick:j,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(n,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),0===a.length?e.jsxs("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[e.jsx(o,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No IPFS content found"})]}):e.jsx("div",{className:"space-y-4",children:a.map((r=>{return e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-700 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-2xl",children:k(r.type)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:r.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full",children:r.type}),r.mime_type&&e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full",children:r.mime_type}),r.size&&e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full",children:b(r.size)}),e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 px-2 py-1 rounded-full",children:(s=r.created_at,new Date(s).toLocaleDateString())})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 font-mono break-all",children:r.cid}),r.chunks&&r.chunks.length>0&&e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[r.chunks.length," chunks"]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("a",{href:`https://ipfs.io/ipfs/${r.cid}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors",children:e.jsx(x,{size:20,className:"text-gray-500 dark:text-gray-400"})}),e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this content? This will only remove it from the registry, not from IPFS."))try{const{error:t}=await c.from("ipfs_content").delete().eq("id",e);if(t)throw t;m(a.filter((t=>t.id!==e)))}catch(t){console.error("Error deleting IPFS content:",t),alert("Failed to delete content")}})(r.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(d,{size:20,className:"text-red-500"})})]})]})},r.id);var s}))})]}):e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-xl p-6 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-yellow-500 mx-auto mb-2"}),e.jsx("p",{className:"text-yellow-600 dark:text-yellow-400 mb-4",children:"IPFS service is not initialized. This feature requires IPFS to be properly configured."})]})};export{m as IPFSContentManager};
