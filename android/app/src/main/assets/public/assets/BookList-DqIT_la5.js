import{j as e,m as r}from"./framer--EiQgGdQ.js";import{r as t}from"./vendor-fbM9bkeS.js";import{s,L as a,a as o}from"./index-CGXY-R5d.js";import{BookEditor as i}from"./BookEditor-DQ9IFxA9.js";import{P as l}from"./pen-DKwZTjy7.js";import{T as c}from"./trash-2-q4_jv6YM.js";import"./utils-DiRS1ToC.js";import"./supabase-DkUcngs9.js";import"./ui-Yji1MIDK.js";import"./upload-lX1edj6g.js";const n=()=>{const[n,d]=t.useState([]),[m,x]=t.useState(!0),[p,h]=t.useState(null),[j,g]=t.useState(null);t.useEffect((()=>{u()}),[]);const u=async()=>{try{x(!0),h(null);const{data:e,error:r}=await s.from("books").select("*").order("created_at",{ascending:!1});if(r)throw r;d(e||[])}catch(e){console.error("Error fetching books:",e),h("Failed to load books")}finally{x(!1)}};return m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(a,{className:"w-8 h-8 text-primary-500 animate-spin"})}):p?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-6 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-red-500 mb-4",children:p}),e.jsx("button",{onClick:u,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:"Try Again"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[n.map((t=>e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-700 rounded-xl p-4 flex items-center space-x-4",children:[e.jsx("img",{src:t.cover_url,alt:t.title,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.author}),e.jsxs("p",{className:"text-sm text-primary-500",children:["UGX ",t.digital_price.toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>g(t),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors",children:e.jsx(l,{size:20,className:"text-gray-500 dark:text-gray-400"})}),e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this book?"))try{const{error:r}=await s.from("books").delete().eq("id",e);if(r)throw r;d(n.filter((r=>r.id!==e)))}catch(r){console.error("Error deleting book:",r),alert("Failed to delete book")}})(t.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(c,{size:20,className:"text-red-500"})})]})]},t.id))),0===n.length&&e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"No books found"})]}),j&&e.jsx(i,{book:j,onSave:e=>{d(n.map((r=>r.id===e.id?e:r))),g(null)},onCancel:()=>g(null)})]})};export{n as BookList};
