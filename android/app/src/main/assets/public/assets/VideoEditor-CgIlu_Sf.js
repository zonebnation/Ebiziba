import{j as e,m as r}from"./framer--EiQgGdQ.js";import{r as a}from"./vendor-fbM9bkeS.js";import{X as t,L as s,s as l}from"./index-CGXY-R5d.js";import{U as i}from"./upload-lX1edj6g.js";import"./utils-DiRS1ToC.js";import"./supabase-DkUcngs9.js";import"./ui-Yji1MIDK.js";const d=({video:d,onSave:o,onCancel:n})=>{const[c,u]=a.useState(d.title),[m,x]=a.useState(d.description),[b,g]=a.useState(null),[p,y]=a.useState(null),[h,f]=a.useState(!1),[v,j]=a.useState(null),[k,N]=a.useState(0),w=a.useRef(null),C=a.useRef(null),S=async(e,r)=>{const a=e.name.split(".").pop(),t=`${Math.random().toString(36).slice(2)}.${a}`,s=`${d.id}/${t}`,{data:i,error:o}=await l.storage.from(r).upload(s,e,{upsert:!0,onUploadProgress:e=>{const r=e.loaded/e.total*100;N(r)}});if(o)throw o;const{data:{publicUrl:n}}=l.storage.from(r).getPublicUrl(s);return n};return e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Video"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:e.jsx(t,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),v&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 text-red-500 rounded-lg text-sm",children:v}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),c.trim()&&m.trim())try{f(!0),j(null);let e={title:c,description:m};b&&(e.video_url=await S(b,"videos")),p&&(e.thumbnail_url=await S(p,"thumbnails"));const{data:r,error:a}=await l.from("reels").update(e).eq("id",d.id).select().single();if(a)throw a;if(!r)throw new Error("No data returned from update");o(r)}catch(r){console.error("Error updating video:",r),j("Failed to update video")}finally{f(!1)}else j("Please fill in all required fields")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:outline-none focus:border-primary-500 dark:focus:border-primary-500 bg-white dark:bg-gray-800",placeholder:"Enter video title",disabled:h})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:m,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 focus:outline-none focus:border-primary-500 dark:focus:border-primary-500 bg-white dark:bg-gray-800",placeholder:"Enter video description",rows:3,disabled:h})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"file",ref:w,onChange:e=>{var r;const a=null==(r=e.target.files)?void 0:r[0];a&&(a.type.startsWith("video/")?a.size>104857600?j("Video file size must be less than 100MB"):(g(a),j(null)):j("Please select a valid video file"))},accept:"video/*",className:"hidden",disabled:h}),e.jsxs("button",{type:"button",onClick:()=>{var e;return null==(e=w.current)?void 0:e.click()},className:"w-full p-4 border-2 border-dashed rounded-lg flex flex-col items-center justify-center space-y-2 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",disabled:h,children:[e.jsx(i,{size:24,className:"text-gray-400"}),e.jsxs("div",{className:"text-sm text-center text-gray-500 dark:text-gray-400",children:["Click to upload new video",e.jsx("br",{}),e.jsx("span",{className:"text-xs",children:"Optional - MP4, WebM or OGG (Max 100MB)"})]})]})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",ref:C,onChange:e=>{var r;const a=null==(r=e.target.files)?void 0:r[0];a&&(a.type.startsWith("image/")?a.size>2097152?j("Thumbnail image size must be less than 2MB"):(y(a),j(null)):j("Please select a valid image file for thumbnail"))},accept:"image/*",className:"hidden",disabled:h}),e.jsxs("button",{type:"button",onClick:()=>{var e;return null==(e=C.current)?void 0:e.click()},className:"w-full p-4 border-2 border-dashed rounded-lg flex flex-col items-center justify-center space-y-2 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",disabled:h,children:[e.jsx(i,{size:24,className:"text-gray-400"}),e.jsxs("div",{className:"text-sm text-center text-gray-500 dark:text-gray-400",children:["Click to upload new thumbnail",e.jsx("br",{}),e.jsx("span",{className:"text-xs",children:"Optional - JPG, PNG or GIF (Max 2MB)"})]})]})]})]}),h&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:`${k}%`}})}),e.jsxs("p",{className:"text-sm text-center text-gray-500 dark:text-gray-400",children:["Uploading... ",Math.round(k),"%"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:h,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:"flex-1 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:h?e.jsx(s,{className:"w-5 h-5 animate-spin"}):"Save Changes"})]})]})]})})})};export{d as VideoEditor};
